# Test Report Generator

This directory contains scripts for generating test overview reports for the sandbox project.

## Scripts

### generate_test_report.py

Generates a comprehensive test overview report by scanning all test modules in the repository.

**Features:**
- Scans all `*_test` modules
- Identifies all test methods (`@Test`, `@ParameterizedTest`, `@RepeatedTest`)
- Tracks disabled tests (`@Disabled`) with their reasons
- Generates statistics per plugin and overall
- Outputs both Markdown and JSON formats

**Usage:**

```bash
# Run from repository root
python3 .github/scripts/generate_test_report.py

# Outputs:
# - test-report.md  - Human-readable Markdown report
# - test-report.json - Machine-readable JSON for automation
```

**Generated Report Includes:**
- Overall statistics (total tests, enabled/disabled counts)
- Per-plugin summary table
- Detailed list of all disabled tests with reasons and file locations

## GitHub Actions Integration

The test report is automatically generated by the `Test Report` workflow (`.github/workflows/test-report.yml`):

- **Runs on:** Push to main, pull requests, daily schedule, manual trigger
- **Artifacts:** Reports are uploaded and retained for 90 days
- **PR Comments:** On pull requests, the report is posted as a comment
- **GitHub Summary:** The report is displayed in the workflow run summary

### Viewing Reports

1. **In Pull Requests:** Check the bot comment with the test overview
2. **In GitHub Actions:** Check the "Summary" tab of workflow runs
3. **As Artifacts:** Download from the workflow run artifacts

### Manual Trigger

You can manually trigger the workflow from the Actions tab to generate an up-to-date report.

## Report Format

### Markdown Report (`test-report.md`)

Example:

```markdown
# JUnit Test Overview Report

## Overall Statistics

- **Total Test Modules:** 9
- **Total Test Files:** 25
- **Total Tests:** 257
- **Enabled Tests:** 213 (82%)
- **Disabled Tests:** 44 (17%)

## Test Summary by Plugin

| Plugin | Test Files | Total Tests | Enabled | Disabled | Disabled % |
|--------|------------|-------------|---------|----------|-----------|
| sandbox_encoding_quickfix_test | 3 | 8 | 7 | 1 | 12% |
...

## Disabled Tests Details

### sandbox_encoding_quickfix_test (1 disabled)

- `org.eclipse.jdt.ui.tests.quickfix.Java10.ExplicitEncodingCleanUpTest.testExplicitEncodingParametrizedAggregateUTF8()` - Not Implemented
  - File: `sandbox_encoding_quickfix_test/src/org/eclipse/jdt/ui/tests/quickfix/Java10/ExplicitEncodingCleanUpTest.java:79`
```

### JSON Report (`test-report.json`)

Machine-readable format containing:
- `summary`: Overall statistics
- `plugins`: Per-plugin detailed statistics
- `disabled_tests`: Array of all disabled test details

## Maintenance

### Adding Test Detection Support

The script currently detects:
- `@Test`
- `@ParameterizedTest`
- `@RepeatedTest`

To add support for additional test annotations, modify the `scan_java_file` method in `generate_test_report.py`.

### Modifying Report Format

- **Markdown format:** Edit `generate_markdown_report` method
- **JSON format:** Edit `generate_json_report` method
- **Statistics:** Edit `generate_summary` method

## Notes

- The script uses regex-based parsing (not a full Java parser) for simplicity and speed
- Commented-out `@Disabled` annotations are not counted as disabled
- Disabled test reasons are extracted from `@Disabled("reason")` annotations
- File paths are relative to repository root
