<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>ExampleHintProvider.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">sandbox_coverage</a> &gt; <a href="../index.html" class="el_bundle">sandbox_common</a> &gt; <a href="index.source.html" class="el_package">org.sandbox.jdt.triggerpattern.examples</a> &gt; <span class="el_source">ExampleHintProvider.java</span></div><h1>ExampleHintProvider.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (c) 2025 Carsten Hammer.
 *
 * This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License 2.0
 * which accompanies this distribution, and is available at
 * https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     Carsten Hammer - initial API and implementation
 *******************************************************************************/
package org.sandbox.jdt.triggerpattern.examples;

import org.eclipse.jdt.core.dom.AST;
import org.eclipse.jdt.core.dom.ASTNode;
import org.eclipse.jdt.core.dom.Expression;
import org.eclipse.jdt.core.dom.InfixExpression;
import org.eclipse.jdt.core.dom.PrefixExpression;
import org.eclipse.jdt.ui.text.java.IJavaCompletionProposal;
import org.eclipse.jdt.ui.text.java.correction.ASTRewriteCorrectionProposal;
import org.eclipse.swt.graphics.Image;
import org.sandbox.jdt.triggerpattern.api.Hint;
import org.sandbox.jdt.triggerpattern.api.HintContext;
import org.sandbox.jdt.triggerpattern.api.PatternKind;
import org.sandbox.jdt.triggerpattern.api.TriggerPattern;

/**
 * Example hint provider demonstrating trigger pattern usage.
 * 
 * &lt;p&gt;This class shows how to create hints using annotations.&lt;/p&gt;
 * 
 * @since 1.2.2
 */
<span class="nc" id="L36">public class ExampleHintProvider {</span>

/**
 * Suggests replacing {@code $x + 1} with {@code ++$x} or {@code $x++}.
 * 
 * &lt;p&gt;Example: {@code a + 1} becomes {@code ++a}&lt;/p&gt;
 */
@TriggerPattern(value = &quot;$x + 1&quot;, kind = PatternKind.EXPRESSION)
@Hint(displayName = &quot;Replace with increment operator&quot;, 
      description = &quot;Replaces addition by 1 with the increment operator (++)&quot;)
public static IJavaCompletionProposal simplifyIncrement(HintContext ctx) {
<span class="nc" id="L47">	ASTNode matchedNode = ctx.getMatch().getMatchedNode();</span>

<span class="nc bnc" id="L49" title="All 2 branches missed.">	if (!(matchedNode instanceof InfixExpression)) {</span>
<span class="nc" id="L50">	return null;</span>
	}

<span class="nc" id="L53">	InfixExpression infixExpr = (InfixExpression) matchedNode;</span>

	// Get the bound variable from placeholders
<span class="nc" id="L56">	ASTNode xNode = ctx.getMatch().getBindings().get(&quot;$x&quot;); //$NON-NLS-1$</span>
<span class="nc bnc" id="L57" title="All 4 branches missed.">	if (xNode == null || !(xNode instanceof Expression)) {</span>
<span class="nc" id="L58">	return null;</span>
	}

<span class="nc" id="L61">	Expression variable = (Expression) xNode;</span>

	// Create the replacement: ++variable
<span class="nc" id="L64">	AST ast = ctx.getASTRewrite().getAST();</span>
<span class="nc" id="L65">	PrefixExpression prefixExpr = ast.newPrefixExpression();</span>
<span class="nc" id="L66">	prefixExpr.setOperator(PrefixExpression.Operator.INCREMENT);</span>
<span class="nc" id="L67">	prefixExpr.setOperand((Expression) ASTNode.copySubtree(ast, variable));</span>

	// Apply the rewrite
<span class="nc" id="L70">	ctx.getASTRewrite().replace(infixExpr, prefixExpr, null);</span>

	// Create the proposal
<span class="nc" id="L73">	String label = &quot;Replace '&quot; + infixExpr + &quot;' with '++' operator&quot;; //$NON-NLS-1$ //$NON-NLS-2$</span>
<span class="nc" id="L74">	ASTRewriteCorrectionProposal proposal = new ASTRewriteCorrectionProposal(</span>
<span class="nc" id="L75">	label,</span>
<span class="nc" id="L76">	ctx.getICompilationUnit(),</span>
<span class="nc" id="L77">	ctx.getASTRewrite(),</span>
<span class="nc" id="L78">	10, // relevance</span>
<span class="nc" id="L79">	(Image) null</span>
	);

<span class="nc" id="L82">	return proposal;</span>
}

/**
 * Suggests replacing {@code $x - 1} with {@code --$x} or {@code $x--}.
 * 
 * &lt;p&gt;Example: {@code a - 1} becomes {@code --a}&lt;/p&gt;
 */
@TriggerPattern(value = &quot;$x - 1&quot;, kind = PatternKind.EXPRESSION)
@Hint(displayName = &quot;Replace with decrement operator&quot;,
      description = &quot;Replaces subtraction by 1 with the decrement operator (--)&quot;)
public static IJavaCompletionProposal simplifyDecrement(HintContext ctx) {
<span class="nc" id="L94">	ASTNode matchedNode = ctx.getMatch().getMatchedNode();</span>

<span class="nc bnc" id="L96" title="All 2 branches missed.">	if (!(matchedNode instanceof InfixExpression)) {</span>
<span class="nc" id="L97">	return null;</span>
	}

<span class="nc" id="L100">	InfixExpression infixExpr = (InfixExpression) matchedNode;</span>

	// Get the bound variable
<span class="nc" id="L103">	ASTNode xNode = ctx.getMatch().getBindings().get(&quot;$x&quot;); //$NON-NLS-1$</span>
<span class="nc bnc" id="L104" title="All 4 branches missed.">	if (xNode == null || !(xNode instanceof Expression)) {</span>
<span class="nc" id="L105">	return null;</span>
	}

<span class="nc" id="L108">	Expression variable = (Expression) xNode;</span>

	// Create the replacement: --variable
<span class="nc" id="L111">	AST ast = ctx.getASTRewrite().getAST();</span>
<span class="nc" id="L112">	PrefixExpression prefixExpr = ast.newPrefixExpression();</span>
<span class="nc" id="L113">	prefixExpr.setOperator(PrefixExpression.Operator.DECREMENT);</span>
<span class="nc" id="L114">	prefixExpr.setOperand((Expression) ASTNode.copySubtree(ast, variable));</span>

	// Apply the rewrite
<span class="nc" id="L117">	ctx.getASTRewrite().replace(infixExpr, prefixExpr, null);</span>

	// Create the proposal
<span class="nc" id="L120">	String label = &quot;Replace '&quot; + infixExpr + &quot;' with '--' operator&quot;; //$NON-NLS-1$ //$NON-NLS-2$</span>
<span class="nc" id="L121">	ASTRewriteCorrectionProposal proposal = new ASTRewriteCorrectionProposal(</span>
<span class="nc" id="L122">	label,</span>
<span class="nc" id="L123">	ctx.getICompilationUnit(),</span>
<span class="nc" id="L124">	ctx.getASTRewrite(),</span>
<span class="nc" id="L125">	10, // relevance</span>
<span class="nc" id="L126">	(Image) null</span>
	);

<span class="nc" id="L129">	return proposal;</span>
}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>